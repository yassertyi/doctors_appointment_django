<style>
    .list-group {
        max-height: 500px;
        overflow-y: auto;
        margin-bottom: 20px;
    }
    
    .list-group-item {
        border-radius: 0.375rem;
        padding: 15px;
    }
    
    .list-group-item-warning {
        background-color: #d4edda;
        color: #155724;
    }
    
    .list-group-item-success {
        background-color: #d4edda;
        color: #155724;
    }
    
    .alert-info {
        margin-top: 20px;
    }
    </style>
    
    {% block content %}
    
    <div class="col-md-7 col-lg-8 col-xl-9 section notifications_list d-none">
    
        <div class="row">
            <div class="col-sm-12">
                <div class="card">
                    <div class="card-body">
                        <div class="card card-table mb-0">
                            <div class="card-body">
        <h2 class="text-center mb-4">الإشعارات</h2>
    
        {% if notifications %}
        <div class="list-group" id="notificationList">
            {% for notification in notifications %}
                <div class="list-group-item d-flex justify-content-between align-items-center 
                    {% if notification.status == '0' %} list-group-item-warning {% else %} list-group-item-success {% endif %}">
                    
                    <div>
                        <h5 class="mb-1">{{ notification.message }}</h5>
                        <small>{{ notification.send_time|date:"Y-m-d H:i" }}</small> 
                        <br>
                        <small>من: {{ notification.sender.username }}</small>
                        <br>
                        <small>نوع الإشعار: 
                            {% if notification.notification_type == '0' %} معلومة
                            {% elif notification.notification_type == '1' %} تحذير
                            {% elif notification.notification_type == '2' %} نجاح
                            {% elif notification.notification_type == '3' %} خطأ
                            {% endif %}
                        </small>
                    </div>
        
                    <!-- زر حذف الإشعار -->
                    <button class="btn btn-danger btn-sm" onclick="confirmDeleteNotification('{{ notification.id }}')">
                        حذف
                    </button>
                    
                </div>
            {% endfor %}
        </div>
        
        
        {% else %}
            <div class="alert alert-info text-center">لا توجد إشعارات حالياً.</div>
        {% endif %}
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    
    <script>
function confirmDeleteNotification(notificationId) {
    // التأكد من أن notificationId يتم تمريره بشكل صحيح
    console.log("Notification ID:", notificationId);

    const userConfirmed = confirm("هل أنت متأكد من أنك تريد حذف هذا الإشعار؟");
    if (userConfirmed) {
        fetch("", {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': '{{ csrf_token }}',
            },
            body: JSON.stringify({ 'notification_id': notificationId })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert("تم حذف الإشعار بنجاح.");
                location.reload();
            } else {
                alert(data.error || "حدث خطأ أثناء حذف الإشعار.");
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("حدث خطأ أثناء الاتصال بالخادم.");
        });
    }
}

    </script>
    
    {% endblock %}
    