<div class="col-md-7 col-lg-8 col-xl-9 invoices section d-none">
    <div class="card card-table">
        <div class="card-body">
            <!-- Filter Section -->
            <div class="row mb-4">
                <div class="col-md-12">
                    <form id="invoice-filter-form" class="row">
                        <div class="col-md-3 mb-2">
                            <label>من تاريخ</label>
                            <input type="date" name="date_from" class="form-control" value="{{ request.GET.date_from }}">
                        </div>
                        <div class="col-md-3 mb-2">
                            <label>إلى تاريخ</label>
                            <input type="date" name="date_to" class="form-control" value="{{ request.GET.date_to }}">
                        </div>
                        <div class="col-md-3 mb-2">
                            <label>حالة الدفع</label>
                            <select name="payment_status" class="form-control">
                                <option value="">الكل</option>
                                {% for status in payment_statuses %}
                                    <option value="{{ status.id }}" {% if request.GET.payment_status == status.id|stringformat:"s" %}selected{% endif %}>
                                        {{ status.payment_status_name }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-3 mb-2">
                            <label>نطاق المبلغ</label>
                            <div class="input-group">
                                <input type="number" name="amount_min" class="form-control" placeholder="الحد الأدنى" value="{{ request.GET.amount_min }}">
                                <input type="number" name="amount_max" class="form-control" placeholder="الحد الأقصى" value="{{ request.GET.amount_max }}">
                            </div>
                        </div>
                        <div class="col-md-12 text-end">
                            <button type="submit" class="btn btn-primary">تصفية</button>
                            <button type="button" class="btn btn-secondary" id="reset-filter">إعادة تعيين</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Invoice Table -->
            <div class="table-responsive" id="invoice-table-container">
                {% include "frontend/dashboard/hospitals/sections/invoice_table.html" %}
            </div>
            <!-- /Invoice Table -->
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
    function loadInvoices(formData) {
        $.ajax({
            url: '{% url "hospitals:filter_invoices" %}',
            type: 'GET',
            data: formData,
            success: function(response) {
                $('#invoice-table-container').html(response);
            },
            error: function(xhr, status, error) {
                console.error("Error loading invoices:", error);
            }
        });
    }

    // Handle form submission
    $('#invoice-filter-form').on('submit', function(e) {
        e.preventDefault();
        var formData = $(this).serialize();
        loadInvoices(formData);
    });

    // Handle reset button
    $('#reset-filter').on('click', function() {
        $('#invoice-filter-form')[0].reset();
        loadInvoices('');
    });
});
</script>